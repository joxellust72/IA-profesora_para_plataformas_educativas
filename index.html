<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8">
    <title>Chat con WebLLM</title>
    <script src="https://cdn.tailwindcss.com"></script> <!-- Nota: Tailwind recomienda no usar esto en producci√≥n -->
    <!-- Librer√≠as para RAG Local -->
    <script type="module">
        // Transformers.js se carga como m√≥dulo para obtener la funci√≥n 'pipeline'
        import { pipeline } from "https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1";
        window.Transformers = { pipeline };
    </script>
    <!-- Voy.js se carga como un script cl√°sico para que est√© disponible en window.Voy -->
    <script src="https://cdn.jsdelivr.net/npm/voy-search@0.6.2/dist/voy.min.js"></script>
    <!-- PDF.js se carga como un script cl√°sico y se asigna a la variable global que espera app.js -->
    <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.4.168/build/pdf.min.js"></script>

    <!-- Nueva fuente para el efecto de pizarra -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Nunito', sans-serif;
      }
      /* Clase para la fuente de pizarra */
      .msg.bot span:last-child {
        color: #333; /* Color oscuro para la tiza */
        font-weight: bold;
      }
      .msg.user span:last-child {
        color: #000;
        font-weight: bold;
      }
      .chalk-font {
        font-family: 'Permanent Marker', cursive;
        font-size: 1.1rem; /* Hacemos la fuente un poco m√°s grande para que se lea mejor */
      }
    </style>
  </head>
  <body class="h-screen w-full bg-gray-100 overflow-hidden">

    <!-- INICIO: Header de Navegaci√≥n -->
    <header class="bg-red-800 text-white p-4 shadow-md">
      <nav class="container mx-auto flex justify-between items-center">
        <h1 class="text-xl font-bold">Universidad T√©cnica de ASYS</h1>
        <div>
          <a href="#" class="mr-4 hover:underline">Inicio</a>
          <a href="#" class="mr-4 hover:underline">Programas</a>
          <a href="#" class="mr-4 hover:underline">Admisiones</a>
          <a href="#" class="hover:underline">Contacto</a>
        </div>
      </nav>
    </header>
    <!-- FIN: Header de Navegaci√≥n -->

    <!-- INICIO: Contenido de la p√°gina principal (simulado) -->
    <main class="p-10">
      <div class="container mx-auto">
        <h2 class="text-2xl font-semibold mb-4">Materias Destacadas</h2>
        <div class="grid grid-cols-3 gap-4">
          <div class="bg-white p-6 rounded-lg shadow-lg h-48 flex flex-col"> <h3 class="font-bold text-lg mb-2">C√°lculo Diferencial</h3> <p class="text-gray-600 text-sm">Domina los fundamentos del cambio y el movimiento.</p> </div>
          <div class="bg-white p-6 rounded-lg shadow-lg h-48 flex flex-col"> <h3 class="font-bold text-lg mb-2">Programaci√≥n Orientada a Objetos</h3> <p class="text-gray-600 text-sm">Aprende a construir software modular y escalable.</p> </div>
          <div class="bg-white p-6 rounded-lg shadow-lg h-48 flex flex-col"> <h3 class="font-bold text-lg mb-2">Bases de Datos</h3> <p class="text-gray-600 text-sm">Descubre c√≥mo organizar y gestionar grandes vol√∫menes de informaci√≥n.</p> </div>
        </div>
      </div>
    </main>
    <!-- FIN: Contenido de la p√°gina principal -->

    <!-- INICIO: Bot√≥n flotante para abrir el chat -->
    <button id="open-chat-btn" class="fixed bottom-5 right-5 bg-pink-500 text-white w-16 h-16 rounded-full flex items-center justify-center text-3xl shadow-lg hover:bg-pink-600 transition-transform hover:scale-110">
      üë©‚Äçüè´
    </button>
    <!-- FIN: Bot√≥n flotante -->

    <!-- INICIO: Contenedor del Asistente (Oculto por defecto) -->
    <div id="chat-container" class="hidden fixed top-0 right-0 h-full w-1/2 bg-gray-200/50 backdrop-blur-sm shadow-2xl flex flex-row">
      <!-- Bot√≥n de cierre dentro del chat -->
      <button id="close-chat-btn" class="absolute top-4 right-4 bg-red-600 text-white rounded-full w-10 h-10 z-50 hover:bg-red-700">‚úï</button>

      <!-- Columna Izquierda: Chat -->
      <div class="w-2/3 h-full flex flex-col bg-white/50 p-4">
        <!-- √Årea de Mensajes con fondo de pizarra -->
        <div id="chat" class="flex-1 p-6 overflow-y-auto rounded-lg mb-4 bg-no-repeat bg-contain bg-center flex flex-col justify-end" style="background-image: url('img/fondochat.png');">
          <!-- Los mensajes se generan con JS -->
        </div>

        <!-- √Årea de Inputs -->
        <div class="bg-white/90 p-3 flex items-center space-x-2 rounded-lg border border-gray-300">
            <input type="file" id="file-input" class="hidden" accept=".txt,.pdf">
            <button id="upload-btn" class="bg-green-500 hover:bg-green-600 text-white p-2 rounded-full" title="Aprender de Documento">üìÑ</button>
            <input id="user-input" type="text" placeholder="Escribe un mensaje..." class="flex-1 p-2 rounded-lg border-none focus:outline-none focus:ring-0">
            <button id="mic-btn" class="bg-pink-400 hover:bg-pink-500 text-white p-2 rounded-full">üé§</button>
            <button id="stop-btn" class="bg-pink-400 hover:bg-pink-500 text-white p-2 rounded-full hidden">‚è∏Ô∏è</button>
            <button id="send-btn" class="bg-pink-400 hover:bg-pink-500 text-white p-2 rounded-full">‚û§</button>
        </div>
      </div>

      <!-- Columna Derecha: Personaje -->
      <div class="w-1/3 h-full relative">
        <img id="imagen-character" src="img/normal.png" alt="Personaje" 
             class="absolute bottom-0 left-1/2 -translate-x-1/2 h-auto w-full max-w-[25rem] pointer-events-none"
             style="filter: drop-shadow(0 4px 6px rgba(0, 0, 0, 0.2));">
      </div>
    </div>
    <!-- FIN: Contenedor del Asistente -->

    <!-- cargar app como m√≥dulo -->
    <script type="module" src="./src/engine.js"></script>
    <script type="module" src="./src/profileManager.js"></script>
    <script type="module" src="./src/ui.js"></script>
    <script type="module" src="./src/chatController.js"></script>
    <script type="module" src="./app.js"></script>
  </body>
</html>